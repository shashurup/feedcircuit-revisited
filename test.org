#+begin_src clojure :results pp
(ns user
  (:require [feedcircuit-revisited.main :as m]
            [feedcircuit-revisited.feed :as f]
	    [feedcircuit-revisited.content :as c]
	    [feedcircuit-revisited.ui :as u]
	    [feedcircuit-revisited.handler :as handler]
            [hiccup.core :as html]
            [clojure.zip :as zip]
))
#+end_src

#+RESULTS:
: nil

#+name: scratch
#+begin_src clojure :results pp :wrap src clojure
(u/head "blabla" "style-a")
#+end_src

#+RESULTS: scratch
#+begin_src clojure
[:head
 [:title "blabla"]
 [:meta
  {:name "viewport", :content "width=device-width, initial-scale=1.0"}]
 [:script {:src "code.js"}]
 [:link {:rel "stylesheet", :type "text/css", :href "style.css"}]
 ([:link {:rel "stylesheet", :type "text/css", :href "style-a"}])
 [:link {:rel "shortcut icon", :type "image/png", :href "favicon.png"}]]
#+end_src

#+begin_src clojure :results output
(m/_run-srv)
#+end_src

#+RESULTS:
#+begin_example
нояб. 24, 2020 6:46:22 PM feedcircuit-revisited.stat invoke
INFO: Starting statistics collection
нояб. 24, 2020 6:46:22 PM feedcircuit-revisited.feed invoke
INFO: Starting sync by the timer
нояб. 24, 2020 6:46:22 PM feedcircuit-revisited.stat invoke
INFO: Collecting statistics for  http://sgolub.ru/feed/
2020-11-24 18:46:22.990:INFO:oejs.Server:nREPL-session-9db53d66-b7e8-484c-bcf6-7b4aa9030059: jetty-9.4.22.v20191022; built: 2019-10-22T13:37:13.455Z; git: b1e6b55512e008f7fbdf1cbea4ff8a6446d1073b; jvm 11.0.8+10
нояб. 24, 2020 6:46:22 PM feedcircuit-revisited.feed invoke
INFO: Getting news from http://sgolub.ru/feed/
2020-11-24 18:46:23.020:INFO:oejs.AbstractConnector:nREPL-session-9db53d66-b7e8-484c-bcf6-7b4aa9030059: Started ServerConnector@52bb0385{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
2020-11-24 18:46:23.020:INFO:oejs.Server:nREPL-session-9db53d66-b7e8-484c-bcf6-7b4aa9030059: Started @15808ms
#+end_example

#+begin_src clojure :results pp
(m/_restart-srv)
#+end_src

#+RESULTS:
: #'feedcircuit-revisited.main/_srv
: 2020-10-10 15:54:02.952:INFO:oejs.AbstractConnector:nREPL-session-88bac6bb-a57c-4f63-a4d4-aa7c092e07f1: Stopped ServerConnector@43a4a014{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
: 2020-10-10 15:54:02.954:INFO:oejs.Server:nREPL-session-88bac6bb-a57c-4f63-a4d4-aa7c092e07f1: jetty-9.4.22.v20191022; built: 2019-10-22T13:37:13.455Z; git: b1e6b55512e008f7fbdf1cbea4ff8a6446d1073b; jvm 11.0.8+10
: 2020-10-10 15:54:02.956:INFO:oejs.AbstractConnector:nREPL-session-88bac6bb-a57c-4f63-a4d4-aa7c092e07f1: Started ServerConnector@da12376{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
: 2020-10-10 15:54:02.956:INFO:oejs.Server:nREPL-session-88bac6bb-a57c-4f63-a4d4-aa7c092e07f1: Started @13293357ms

#+begin_src clojure :results pp :wrap src clojure
(f/sync!)
#+end_src

#+RESULTS:
#+BEGIN_src clojure
(["https://news.ycombinator.com/rss" 30]
 ["https://clojure.org/feed.xml" 0]
 ["https://www.archlinux.org/feeds/news/" 0]
 ["https://www.anandtech.com/rss/" 0]
 ["http://blog.cleancoder.com/atom.xml" 0]
 ["http://rss.slashdot.org/Slashdot/slashdotMain" 15]
 ["http://feeds.arstechnica.com/arstechnica/index/" 0]
 ["https://www.computerra.ru/feed/" 1]
 ["https://xkcd.com/atom.xml" 0]
 ["https://www.kommersant.ru/RSS/section-world.xml" 3]
 ["https://www.zerohedge.com/fullrss2.xml" 1]
 ["http://static.feed.rbc.ru/rbc/logical/footer/news.rss" 1])
июн. 08, 2020 9:56:03 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://news.ycombinator.com/rss
июн. 08, 2020 9:56:04 AM feedcircuit-revisited.feed invoke
INFO: Got 30 item from https://news.ycombinator.com/rss
июн. 08, 2020 9:56:04 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://clojure.org/feed.xml
июн. 08, 2020 9:56:05 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from https://clojure.org/feed.xml
июн. 08, 2020 9:56:05 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://www.archlinux.org/feeds/news/
июн. 08, 2020 9:56:05 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from https://www.archlinux.org/feeds/news/
июн. 08, 2020 9:56:05 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://www.anandtech.com/rss/
июн. 08, 2020 9:56:07 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from https://www.anandtech.com/rss/
июн. 08, 2020 9:56:07 AM feedcircuit-revisited.feed invoke
INFO: Getting news from http://blog.cleancoder.com/atom.xml
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from http://blog.cleancoder.com/atom.xml
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Getting news from http://rss.slashdot.org/Slashdot/slashdotMain
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Got 15 item from http://rss.slashdot.org/Slashdot/slashdotMain
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Getting news from http://feeds.arstechnica.com/arstechnica/index/
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from http://feeds.arstechnica.com/arstechnica/index/
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://www.computerra.ru/feed/
июн. 08, 2020 9:56:09 AM feedcircuit-revisited.feed invoke
INFO: Got 1 item from https://www.computerra.ru/feed/
июн. 08, 2020 9:56:09 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://xkcd.com/atom.xml
июн. 08, 2020 9:56:09 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from https://xkcd.com/atom.xml
июн. 08, 2020 9:56:09 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://www.kommersant.ru/RSS/section-world.xml
июн. 08, 2020 9:56:10 AM feedcircuit-revisited.feed invoke
INFO: Got 3 item from https://www.kommersant.ru/RSS/section-world.xml
июн. 08, 2020 9:56:10 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://www.zerohedge.com/fullrss2.xml
июн. 08, 2020 9:56:13 AM feedcircuit-revisited.feed invoke
INFO: Got 1 item from https://www.zerohedge.com/fullrss2.xml
июн. 08, 2020 9:56:13 AM feedcircuit-revisited.feed invoke
INFO: Getting news from http://static.feed.rbc.ru/rbc/logical/footer/news.rss
июн. 08, 2020 9:56:13 AM feedcircuit-revisited.feed invoke
INFO: Got 1 item from http://static.feed.rbc.ru/rbc/logical/footer/news.rss
#+END_src

#+begin_src clojure :results pp :wrap src clojure
@f/feed-dir
#+end_src

#+RESULTS:
#+BEGIN_src clojure
{"http://sgolub.ru/feed/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/sgolub.ru.feed.",
 "https://news.ycombinator.com/rss"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/news.ycombinator.com.rss",
 "http://www.opennet.ru/opennews/opennews_all.rss"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.opennet.ru.opennews.opennews_all.rss",
 "https://www.kommersant.ru/RSS/section-politics.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-politics.xml",
 "http://4pda.ru/feed/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/4pda.ru.feed.",
 "https://clojure.org/feed.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/clojure.org.feed.xml",
 "https://www.archlinux.org/feeds/news/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.archlinux.org.feeds.news.",
 "https://www.anandtech.com/rss/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.anandtech.com.rss.",
 "https://www.kommersant.ru/RSS/section-hitech.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-hitech.xml",
 "http://blog.cleancoder.com/atom.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/blog.cleancoder.com.atom.xml",
 "https://www.kommersant.ru/RSS/Autopilot_on.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.Autopilot_on.xml",
 "https://bikepost.ru/rss/index/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/bikepost.ru.rss.index.",
 "http://rss.slashdot.org/Slashdot/slashdotMain"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/rss.slashdot.org.Slashdot.slashdotMain",
 "http://feeds.arstechnica.com/arstechnica/index/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/feeds.arstechnica.com.arstechnica.index.",
 "https://www.computerra.ru/feed/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.computerra.ru.feed.",
 "https://exler.ru/films/rss.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/exler.ru.films.rss.xml",
 "https://xkcd.com/atom.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/xkcd.com.atom.xml",
 "https://content.novayagazeta.ru/rss/all.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/content.novayagazeta.ru.rss.all.xml",
 "https://www.kommersant.ru/RSS/section-world.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-world.xml",
 "https://www.archlinux.org/feeds/packages/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.archlinux.org.feeds.packages.",
 "http://comicfeeds.chrisbenard.net/view/dilbert/default"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/comicfeeds.chrisbenard.net.view.dilbert.default",
 "https://www.zerohedge.com/fullrss2.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.zerohedge.com.fullrss2.xml",
 "https://lenta.ru/rss"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/lenta.ru.rss",
 "https://kiwibyrd.org/feed/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/kiwibyrd.org.feed.",
 "http://static.feed.rbc.ru/rbc/logical/footer/news.rss"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/static.feed.rbc.ru.rbc.logical.footer.news.rss"}
#+END_src

#+begin_src clojure :results pp :wrap src clojure
(c/detect (c/retrieve-and-parse "https://bikepost.ru/blog/91216/Ocherednoj-raz-vokrug-Ladogi.html") "https://bikepost.ru" nil)
#+end_src

#+RESULTS:
#+BEGIN_src clojure
class java.net.MalformedURLExceptionclass java.lang.NullPointerExceptionExecution error (NullPointerException) at java.net.URL/<init> (URL.java:585).
null
#+END_src
