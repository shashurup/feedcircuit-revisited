#+begin_src clojure :results pp
(ns user
  (:require [feedcircuit-revisited.main :as m]
            [feedcircuit-revisited.feed :as f]
	    [feedcircuit-revisited.content :as c]
	    [feedcircuit-revisited.ui :as u]
	    [feedcircuit-revisited.handler :as handler]
	    [feedcircuit-revisited.storage :as storage]
            [feedcircuit-revisited.conf :as conf]
            [feedcircuit-revisited.schema :as s]
            [datomic.client.api :as d]
            [hiccup.core :as html]
            [clojure.zip :as zip]
            [me.raynes.fs :as fs]
            [clojure.xml :as xml]
))
#+end_src

#+RESULTS:
: 
: 

#+begin_src clojure :results pp
(->> (d/index-pull (d/db s/db-conn)
                   {:index :avet
                    :selector '[*]
                    :start '[:item/num 42]})
     (filter #(= (get-in % [:item/feed :db/id]) 83562883726309))               
     (take 16))
#+end_src

#+RESULTS:
#+begin_example
({:db/id 96757023259664,
  :item/id "https://www.exler.ru/films/lyudi-v-chernom-1.htm",
  :item/num 42,
  :item/link "https://www.exler.ru/films/lyudi-v-chernom-1.htm",
  :item/title "Люди в черном: Интернэшнл",
  :item/summary
  "<p><a class=\"fancybox\" src=\"https://www.exler.ru/img/films/02-09-2019/big/1.jpg\" rel=\"media\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\"  src=\"https://www.exler.ru/img/films/02-09-2019/1.jpg\"  /></a>Когда-то давно маленькая Молли (Тесса Томпсон) увидела людей в черном за работой - они поджигали мозги ее родителям, чтобы те все забыли. И с той поры девчушка стала мечтать быть в команде этих замечательных людей. Она выросла, стала работать в кол-центре, а по вечерам ходит на кастинги в ФБР, ЦРУ, Госдеп и прочие почтенные заведения, требуя устроить ее в агентство, где все в черных костюмчиках и ручкаются с инопланетянами.",
  :item/published "2019-09-02T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259665,
  :item/id "https://www.exler.ru/films/chernobyl.htm",
  :item/num 43,
  :item/link "https://www.exler.ru/films/chernobyl.htm",
  :item/title "Чернобыль",
  :item/summary
  "<p><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/05-09-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/05-09-2019/1.jpg\"></img></a>Сериал начинается с того, что академик Валерий Легасов (Джаред Харрис), два года назад сыгравший огромную роль в ликвидации аварии на Чернобыльской АЭС, начитывает на диктофон малоизвестные факты о катастрофе на ЧАЭС. Записанные кассеты Легасов прячет в потайном месте, откуда их должны забрать, после чего вешается в своей квартире.</p>",
  :item/published "2019-09-05T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259666,
  :item/id "https://www.exler.ru/films/dzhon-uik-3.htm",
  :item/num 44,
  :item/link "https://www.exler.ru/films/dzhon-uik-3.htm",
  :item/title "Джон Уик 3",
  :item/summary
  "<p align=\"left\"><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/09-09-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/09-09-2019/1.jpg\"></img></a>Для тех зрителей, которые только что подключились к нашей передаче, кратко напомним содержание двух предыдущих серий. В первой серии страшный киллер Джон Уик по кличке Баба Яга (Киану Ривз) удалился на покой, выкосив половину Нью-Йорка по приказу русского криминального авторитета Вигго Зигфридовича Тарасофф. Когда Джон Уик находился на покое, сынишка Вигго с двумя другими придурками забрались в дом Джона Уика и наваляли страшному киллеру конкретных люлей. При этом убили его собаку и забрали его машину. После этого Джон Уик встал, отправился в \"Континенталь\", там получил оружие и черный костюмчик, ну и далее уложил все достопочтенное семейство Вигго вместе с его шебутным сынишкой и несколькими сотнями бойцов.</p>",
  :item/published "2019-09-09T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259667,
  :item/id
  "https://www.exler.ru/films/ohotnik-za-razumom-vtoroj-sezon.htm",
  :item/num 45,
  :item/link
  "https://www.exler.ru/films/ohotnik-za-razumom-vtoroj-sezon.htm",
  :item/title "Охотник за разумом. Второй сезон",
  :item/summary
  "<p align=\"left\"><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/16-09-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/16-09-2019/1.jpg\"></img></a>В <a src=\"https://www.exler.ru/films/ohotnik-za-razumom.htm\">первом сезоне</a> сериала \"Охотник за разумом\" рассказывалось о том, как два спецагента ФБР Холден Форд (Джонатан Грофф) и Билли Тенч (Холт МакКэллани) изучают поведенческие портреты знаменитых убийц и открывают само понятие \"серийный убийца\", которое означает, что этот человек совершает все свои убийства по определенной схеме. Им в этой работе помогает профессор психологии Венди Карр (Анна Торв). </p>",
  :item/published "2019-09-16T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259668,
  :item/id "https://www.exler.ru/films/samyj-zhestokij-god.htm",
  :item/num 46,
  :item/link "https://www.exler.ru/films/samyj-zhestokij-god.htm",
  :item/title "Самый жестокий год",
  :item/summary
  "<p><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/19-09-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/19-09-2019/1.jpg\"></img></a>Нью-Йорк, зима 1981 года, Манхэттен. Иммигрант из Латинской Америки Эйбел Моралес (Оскар Айзек) имеет бизнес, связанный с топливоперевозкой. Бизнес развивается довольно активно, Эйбел очень амбициозен и имеет большие планы на будущее. При этом он старается вести бизнес максимально честно и не приемлет решения вопросов бандитскими  методами.</p>",
  :item/published "2019-09-19T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259669,
  :item/id "https://www.exler.ru/films/yesterday.htm",
  :item/num 47,
  :item/link "https://www.exler.ru/films/yesterday.htm",
  :item/title "Yesterday",
  :item/summary
  "<p align=\"left\"><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/23-09-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/23-09-2019/1.jpg\"></img></a>Англичанин индийского происхождения Джек Малик (Химеш Пател) живет в маленьком городке, работает на складе магазина оптовой продажи и мечтает стать музыкантом. У Джека даже есть импресарио - бывшая одноклассница Элли Эпплтон (Лили Джеймс). Впрочем, только она верит в то, что у Джека в музыке есть будущее: скажем прямо, песенки он пишет очень так себе, так что шанс вырваться наверх из маленьких прокуренных клубов у него очень призрачный. </p>",
  :item/published "2019-09-23T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259670,
  :item/id "https://www.exler.ru/films/prishelcy-iz-proshlogo.htm",
  :item/num 48,
  :item/link "https://www.exler.ru/films/prishelcy-iz-proshlogo.htm",
  :item/title "Пришельцы из прошлого",
  :item/summary
  "<p align=\"left\"><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/26-09-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/26-09-2019/1.jpg\"></img></a>Современная Норвегия, Осло. Несколько лет назад в городе начали появляться пришельцы из прошлого, причем из определенных временных промежутков: пещерные люди, викинги и аристократия XIX века. Прибывают они из океана: там происходит какая-то зеленая вспышка, после чего на поверхность начинают всплывать люди. Что это за порталы такие во времени - никто понять не может. </p>",
  :item/published "2019-09-26T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259671,
  :item/id
  "https://www.exler.ru/films/chelovek-pauk-vdali-ot-doma.htm",
  :item/num 49,
  :item/link
  "https://www.exler.ru/films/chelovek-pauk-vdali-ot-doma.htm",
  :item/title "Человек-паук: Вдали от дома",
  :item/summary
  "<p><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/30-09-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/30-09-2019/1.jpg\"></img></a>События в новом фильме происходят после <a src=\"https://www.exler.ru/films/mstiteli-final.htm\">финала Мстителей</a>, в котором супергерои наконец-то одолели санитара природы Таноса и восстановили распыленное население, но потеряли Тони Старка. Питер Паркер (Том Холланд), он же Человек-паук, грустит: Тони Старк для него был кумиром и наставником. И Питеру надоела вся эта супергеройская возня: он все-таки школьник, у него есть виды на неприступную красотку-одноклассницу Эм Джей (Зендея), а тут еще классу предстоит поехать в путешествие по Европе, так что у Питера есть шанс попробовать завоевать сердце красавицы: ну кто сможет устоять, когда тебе на верхней площадке Эйфелевой башни вручат красивую безделушку?</p>",
  :item/published "2019-09-30T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259672,
  :item/id "https://www.exler.ru/films/bol-i-slava.htm",
  :item/num 50,
  :item/link "https://www.exler.ru/films/bol-i-slava.htm",
  :item/title "Боль и слава",
  :item/summary
  "<p align=\"left\"><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/03-10-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/03-10-2019/1.jpg\"></img></a>Сальвадор Майо (Антонио Бандерас) - стареющий режиссер, который пережил свой пик славы не один десяток лет назад. Он давно не снимает, находится в творческом кризисе. Одинок, очень болен и несчастен. Сальвадор - сосредоточение всевозможных болезней: бессоница, хронические фарингиты, отиты, рефлюкс, язва, бронхиальная астма, мышечные боли в пояснице, спине, коленях и плечах, боли в суставах, постоянный звон в ушах, хрипы и свисты в легких, постоянные мигрени, проблемы с позвоночником. А тут еще и новая странная проблема, которая не позволяет ему просто глотать таблетки: их приходится растирать в пыль, чтобы он не подавился. И Сальвадор боится, что это признак какого-то страшного заболевания. </p>",
  :item/published "2019-10-03T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259673,
  :item/id "https://www.exler.ru/films/tajna-pechati-drakona.htm",
  :item/num 51,
  :item/link "https://www.exler.ru/films/tajna-pechati-drakona.htm",
  :item/title "Тайна печати дракона",
  :item/summary
  "<p><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/07-10-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/07-10-2019/1.jpg\"></img></a>Английский путешественник и географ Джонатан Грин (Джейсон Флеминг) изобрел способ очень точного измерения расстояний, в результате чего он делает карты поразительной подробности и достоверности. Царь Петр I заказал Грину карту европейской части России. Грин отправился в Россию, по пути на беду встретившись с самим Вием, но все-таки добрался до Москвы. </p>",
  :item/published "2019-10-07T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259674,
  :item/id "https://www.exler.ru/films/prestupnik.htm",
  :item/num 52,
  :item/link "https://www.exler.ru/films/prestupnik.htm",
  :item/title "Преступник",
  :item/summary
  "<p><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/10-10-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/10-10-2019/1.jpg\" /></a>Любопытнейший сериальный эксперимент Netflix. Этот сериал почему-то иногда именуют \"юридическим процедуралом\" (<i>процедурал</i> - сериал с независимыми друг от друга сериями, которые можно смотреть по отдельности), однако это скорее расследовательский, то есть детективный процедурал. </p>\r\n\r\n<p>В каждой серии всего три одинаковые локации, которые могут быть в любом городе. Основная локация - комната, в которой происходит допрос предполагаемого преступника. В допросе участвует один детектив, два детектива или один детектив и один вышестоящий инспектор. Во время допроса ведется видеозапись, о чем преступника предупреждают. В комнате висит здоровенное зеркало, за которым находится пункт наблюдения: в нем находятся другие сотрудники полиции - психолог, начальник, специалист по компьютерам и так далее. </p>",
  :item/published "2019-10-10T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259675,
  :item/id "https://www.exler.ru/films/dedvud.htm",
  :item/num 53,
  :item/link "https://www.exler.ru/films/dedvud.htm",
  :item/title "Дэдвуд",
  :item/summary
  "<p align=\"left\"><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/14-10-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/14-10-2019/1.jpg\"></img></a>Об этом фильме невозможно говорить без предыстории, потому что он, по сути, является полнометражным финалом знаменитого одноименного сериала.</p>\r\n\r\n<p align=\"left\">Сериал \"Дэдвуд\" выходил в 2004-2006 годах. Действие начиналось в 1876 году, в сериале рассказывалось о поселке Дэдвуд в Южной Дакоте: поселок был создан старателями во время \"золотой лихорадки\". Кроме старателей в поселок, который постепенно будет превращаться в городок, стекаются всякие авантюристы и преступники. </p>",
  :item/published "2019-10-14T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259676,
  :item/id "https://www.exler.ru/films/el-camino-vo-vse-tyazhkie.htm",
  :item/num 54,
  :item/link
  "https://www.exler.ru/films/el-camino-vo-vse-tyazhkie.htm",
  :item/title "El Camino: Во все тяжкие",
  :item/summary
  "<p align=\"left\"><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/17-10-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/17-10-2019/1.jpg\"></img></a>Идея полнометражного фильма о судьбе Джесси Пинкмана (Аарон Пол) появилась у создателя сериала \"<a src=\"https://www.exler.ru/films/vo-vse-tyazhkie.htm\">Во все тяжкие</a>\" Винса Гиллигана еще во время съемок заключительного сезона. В 2017 году Гиллиган поделился этой идеей с Аароном Полом и тот сказал, что готов в этом участвовать. Сценарий картины Гиллиган написал сам, и он же выступил исполнительным продюсером и собственноручно поставил картину, хотя до этого в полнометражном формате ничего не снимал.</p>",
  :item/published "2019-10-17T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259677,
  :item/id "https://www.exler.ru/films/dryan.htm",
  :item/num 55,
  :item/link "https://www.exler.ru/films/dryan.htm",
  :item/title "Дрянь",
  :item/summary
  "<p><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/09-12-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/09-12-2019/1.jpg\"></img></a>Дрянь (Фиби Уоллер-Бридж) - тридцатилетняя англичанка, живущая в Лондоне. У нее проблемы во взаимоотношениях с ее парнем Гарри (Хью Скиннер), Дрянь ничего не имеет против быстрых знакомств и последующих сексуальных контактов. Она пытается заниматься бизнесом: держит маленькую кафешку, на стенах которых развешены изображения морских свинок. Эту кафешку Дрянь затевала вместе со своей близкой подругой Бу (Дженни Рейнсфорд), однако Бу погибла в результате несчастного случая, что Дрянь очень тяжело переживает, ну и дела у нее в кафешке идут откровенно плохо. </p>",
  :item/published "2019-12-09T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259678,
  :item/id "https://www.exler.ru/films/dzhoker.htm",
  :item/num 56,
  :item/link "https://www.exler.ru/films/dzhoker.htm",
  :item/title "Джокер",
  :item/summary
  "<p><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/12-12-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/12-12-2019/1.jpg\"></img></a>Мрачный город Готэм, начало 1980-х годов. Сорокалетний Артур Флек (Хоакин Феникс) живет в убогой квартирке с больной матерью Пенни (Фрэнсис Конрой). Артур имеет психическое заболевание, полученное в детстве после сильного удара головы, ходит на консультации к психотерапевту, где ему выписывают лекарства. Он мечтает стать стендап-комиком и записывает в тетрадку всякие идеи для шуток и скетчей. </p>",
  :item/published "2019-12-12T06:00:00Z",
  :item/feed #:db{:id 83562883726309}}
 {:db/id 96757023259679,
  :item/id "https://www.exler.ru/films/angry-birds-2-v-kino.htm",
  :item/num 57,
  :item/link "https://www.exler.ru/films/angry-birds-2-v-kino.htm",
  :item/title "Angry Birds 2 в кино",
  :item/summary
  "<p align=\"left\"><a class=\"fancybox\" rel=\"media\" src=\"https://www.exler.ru/img/films/16-12-2019/big/1.jpg\"><img align=\"left\" alt=\"\" border=\"0\" class=\"align-left\" src=\"https://www.exler.ru/img/films/16-12-2019/1.jpg\"></img></a>Позволю себе напомнить содержание <a src=\"https://www.exler.ru/films/angry-birds-v-kino.htm\">предыдущего фильма</a>. На Птичьем острове безмятежно живут птички. Невесело там только Рэду (Джейсон Судейкис) - парии, мизантропу и социопату. В какой-то момент на остров прибыли свиньи со своего Свинского острова. Свиньи для птиц устроили веселое представление, но оказалось, что это просто завеса для подлой операции - свиньи похитили птичьи яйца. И после этого именно рассерженный Рэд организовал экспедицию, которая отправилась на Свинский остров, чтобы вернуть яйца обратно. </p>",
  :item/published "2019-12-16T06:00:00Z",
  :item/feed #:db{:id 83562883726309}})

#+end_example

#+begin_src clojure :results pp
(map first
     (d/q '[:find (pull ?u [:user/id :user/styles {:user-feed/_user [:user-feed/num :user-feed/position :user-feed/feed]}])
            :where [?u :user/id "georgy@kibardin.name"]]
           (d/db s/db-conn)))
#+end_src

#+RESULTS:
: (#:user{:id "georgy@kibardin.name",
:         :styles
:         ["arstechnica.com https://shashurup.github.io/feedcircuit-styles/arstechnica.css"
:          "habr.com https://shashurup.github.io/feedcircuit-styles/img-data-src.js"]})
: 

#+begin_src clojure :results pp
(d/q '[:find (pull ?e [*])
       :where (?e :feed/url _)]
     (d/db s/db-conn))
#+end_src

#+RESULTS:
#+begin_example
[[{:db/id 79164837199971,
   :feed/url "http://sgolub.ru/feed/",
   :feed/title "АВТОРСКИЙ ПРОЕКТ СЕРГЕЯ ГОЛУБИЦКОГО",
   :feed/summary "Авторский проект Сергея Голубицкого",
   :feed/image
   "http://sgolub.ru/wp-content/uploads/image/4/cropped-sgolub2014_sm2-32x32.jpg"}]
 [{:db/id 79164837209002,
   :feed/url "https://www.archlinux.org/feeds/news/",
   :feed/title "Arch Linux: Recent news updates",
   :feed/summary
   "The latest and greatest news from the Arch Linux distribution."}]
 [{:db/id 83562883714910,
   :feed/url "http://feeds.feedburner.com/PythonInsider",
   :feed/title "Python Insider",
   :feed/published "2021-10-14T05:57:27.179-04:00"}]
 [{:db/id 83562883721314,
   :feed/url "https://bikepost.ru/rss/index/",
   :feed/title "БайкПост",
   :feed/summary "БайкПост / RSS channel"}]
 [{:db/id 83562883726309,
   :feed/url "https://exler.ru/films/rss.xml",
   :feed/title "Exler.ru",
   :feed/summary "Кинорецензии"}]
 [{:db/id 87960930222207,
   :feed/url "https://news.ycombinator.com/rss",
   :feed/title "Hacker News",
   :feed/summary
   "Links for the intellectually curious, ranked by readers."}]
 [{:db/id 87960930231160,
   :feed/url "https://clojure.org/feed.xml",
   :feed/title "Clojure News",
   :feed/summary "Clojure News",
   :feed/published "2021-10-14T16:47:17Z"}]
 [{:db/id 87960930232158,
   :feed/url "http://blog.cleancoder.com/atom.xml",
   :feed/title "The Clean Code Blog",
   :feed/published "2021-09-25T15:47:52+00:00"}]
 [{:db/id 87960930232195,
   :feed/url "https://www.kommersant.ru/RSS/Autopilot_on.xml",
   :feed/title "Коммерсантъ Автопилот. Online и Новости",
   :feed/summary
   "ИД \"Коммерсантъ\" - Коммерсантъ Автопилот. Online и Новости",
   :feed/image "https://im.kommersant.ru/pics/yatlogo.gif"}]
 [{:db/id 87960930239514,
   :feed/url "https://www.kommersant.ru/RSS/section-world.xml",
   :feed/title "\"Коммерсантъ\". В мире",
   :feed/summary "Материалы раздела \"В мире\"",
   :feed/image "http://www.kommersant.ru/pics/yatlogo.gif"}]
 [{:db/id 92358976737250,
   :feed/url "https://www.kommersant.ru/RSS/section-politics.xml",
   :feed/title "\"Коммерсантъ\". Политика",
   :feed/summary "Материалы раздела \"Политика\"",
   :feed/image "http://www.kommersant.ru/pics/yatlogo.gif"}]
 [{:db/id 92358976737503,
   :feed/url "http://4pda.ru/feed/",
   :feed/title "4PDA",
   :feed/summary "RSS-лента 4PDA"}]
 [{:db/id 92358976743133,
   :feed/url "https://www.kommersant.ru/RSS/section-hitech.xml",
   :feed/title "\"Коммерсантъ Hi-Tech\"",
   :feed/summary "Материалы раздела \"Hi-Tech\"",
   :feed/image "http://www.kommersant.ru/pics/yatlogo.gif"}]
 [{:db/id 92358976746147,
   :feed/url "http://feeds.arstechnica.com/arstechnica/index/",
   :feed/title "Ars Technica",
   :feed/summary
   "Serving the Technologist for more than a decade. IT news, reviews, and analysis.",
   :feed/image
   "https://cdn.arstechnica.net/wp-content/uploads/2016/10/cropped-ars-logo-512_480-32x32.png"}]
 [{:db/id 92358976748901,
   :feed/url "https://content.novayagazeta.ru/rss/all.xml",
   :feed/title "Новая Газета",
   :feed/summary
   "Журналистские расследования о коррупции в бизнесе и во власти, специальные репортажи с событий политической и культурной жизни, главные новости, галереи, онлайн-кинотеатр, мнения и рецензии ведущих журналистов и экспертов страны",
   :feed/image
   "https://content.novayagazeta.ru/assets/rss-6b5763e8155006d9365b340599231d9eb0fa9418d847b50387c087918531804c.png"}]
 [{:db/id 96757023253490,
   :feed/url "https://www.anandtech.com/rss/",
   :feed/title "AnandTech",
   :feed/summary
   "This channel features the latest computer hardware related articles.",
   :feed/image "http://www.anandtech.com/content/images/rss_logo.png"}]
 [{:db/id 96757023256601,
   :feed/url "http://rss.slashdot.org/Slashdot/slashdotMain",
   :feed/title "Slashdot",
   :feed/summary "News for nerds, stuff that matters",
   :feed/image ""}]
 [{:db/id 101155069759377,
   :feed/url "http://www.opennet.ru/opennews/opennews_all.rss",
   :feed/title "OpenNews.opennet.ru: Общая лента новостей",
   :feed/summary
   "OpenNews - Новости мира открытых систем (Общая лента новостей)"}]
 [{:db/id 101155069764563,
   :feed/url "http://4pda.to/feed/",
   :feed/title "4PDA",
   :feed/summary "RSS-лента 4PDA"}]
 [{:db/id 101155069770926,
   :feed/url "https://xkcd.com/atom.xml",
   :feed/title "xkcd.com",
   :feed/published "2021-10-13T00:00:00Z"}]
 [{:db/id 101155069787727,
   :feed/url "https://kiwibyrd.org/feed/",
   :feed/title "kiwi  arXiv",
   :feed/summary
   "СЮЖЕТЫ & РАССЛЕДОВАНИЯ: мемориально-футуристический склад им. Киви Бёрда (1998-2018)",
   :feed/image "https://s0.wp.com/i/buttonw-com.png"}]
 [{:db/id 105553116280785,
   :feed/url "https://www.computerra.ru/feed/",
   :feed/title "Компьютерра",
   :feed/summary
   "Компьютерра — все новости про новые технологии, IT, инновации, интернет и науку.",
   :feed/image
   "https://www.computerra.ru/wp-content/uploads/2020/10/cropped-dummy.jpg"}]
 [{:db/id 105553116292313,
   :feed/url "http://comicfeeds.chrisbenard.net/view/dilbert/default",
   :feed/title "Dilbert Daily Strip",
   :feed/published "2021-10-15T00:00:00-07:00"}]
 [{:db/id 105553116297227,
   :feed/url "https://lenta.ru/rss",
   :feed/title "Lenta.ru : Новости",
   :feed/summary
   "Новости, статьи, фотографии, видео. Семь дней в неделю, 24 часа в сутки.",
   :feed/image "https://lenta.ru/images/small_logo.png"}]
 [{:db/id 105553116300794,
   :feed/url "http://static.feed.rbc.ru/rbc/logical/footer/news.rss",
   :feed/title "www.rbc.ru",
   :feed/summary "",
   :feed/published "2021-06-08T16:52:42Z",
   :feed/image "http://pics.rbc.ru/img/fp_v4/skin/img/v6-logo.png"}]
 [{:db/id 114349209310844,
   :feed/url "https://www.archlinux.org/feeds/packages/",
   :feed/title "Arch Linux: Recent package updates",
   :feed/summary
   "Recently updated packages in the Arch Linux package repositories."}]
 [{:db/id 114349209312756,
   :feed/url "https://habr.com/ru/rss/best/daily/",
   :feed/title "Лучшие публикации за сутки",
   :feed/summary "Лучшие публикации за последние 24 часа",
   :feed/published "2021-10-15T13:13:11Z",
   :feed/image
   "https://habrastorage.org/webt/ym/el/wk/ymelwk3zy1gawz4nkejl_-ammtc.png"}]
 [{:db/id 114349209314888,
   :feed/url "https://www.zerohedge.com/fullrss2.xml",
   :feed/title "ZeroHedge News",
   :feed/summary ""}]
 [{:db/id 114349209321077,
   :feed/url "http://feeds.feedburner.com/zerohedge/feed",
   :feed/title "ZeroHedge News",
   :feed/summary ""}]]

#+end_example

#+name: scratch
#+begin_src clojure :results pp :wrap src clojure
(letfn [(safe-parse [xml]
         (try
           (xml/parse xml)
           (catch Exception e nil)))]
  (->> (fs/list-dir (fs/expand-home "~/devel/fc-stat/rss"))
       (take 1024)
       (map #(do (println (str %)) %))
       (map safe-parse)
       (filter some?)
       ;(map f/extract-rss-items)
       ;(map #(map f/parse-rss-item %))
       count
))
#+end_src

#+RESULTS: scratch
#+begin_src clojure
13
#+end_src


#+begin_src clojure :results pp :wrap src clojure
(send f/feed-index f/init-feed-index "fc-data")
#+end_src

#+RESULTS:
#+begin_src clojure
#<Agent@775609e6: 
  {"http://sgolub.ru/feed/"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/sgolub.ru.feed.",
    :item-count 26,
    :known-ids
    #{"http://sgolub.ru/?p=13463" "http://sgolub.ru/?p=13611"
      "http://sgolub.ru/?p=13654" "http://sgolub.ru/?p=13520"
      "http://sgolub.ru/?p=13558" "http://sgolub.ru/?p=13684"
      "http://sgolub.ru/?p=13551" "http://sgolub.ru/?p=13458"
      "http://sgolub.ru/?p=13505" "http://sgolub.ru/?p=13511"
      "http://sgolub.ru/?p=13564" "http://sgolub.ru/?p=13584"
      "http://sgolub.ru/?p=13546" "http://sgolub.ru/?p=13580"
      "http://sgolub.ru/?p=13515" "http://sgolub.ru/?p=13473"
      "http://sgolub.ru/?p=13526" "http://sgolub.ru/?p=13538"
      "http://sgolub.ru/?p=13477" "http://sgolub.ru/?p=13643"
      "http://sgolub.ru/?p=13530" "http://sgolub.ru/?p=13571"
      "http://sgolub.ru/?p=13576" "http://sgolub.ru/?p=13595"
      "http://sgolub.ru/?p=13602" "http://sgolub.ru/?p=13534"}},
   "https://news.ycombinator.com/rss"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/news.ycombinator.com.rss"},
   "http://www.opennet.ru/opennews/opennews_all.rss"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.opennet.ru.opennews.opennews_all.rss"},
   "https://www.kommersant.ru/RSS/section-politics.xml"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-politics.xml"},
   "http://4pda.ru/feed/"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/4pda.ru.feed."},
   "https://clojure.org/feed.xml"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/clojure.org.feed.xml",
    :item-count 25,
    :known-ids
    #{"news/2011/07/22/introducing-clojurescript"
      "news/2014/08/06/transducers-are-coming"
      "news/2012/05/08/reducers" "news/2012/02/17/clojure-governance"
      "news/2016/01/19/clojure18"
      "news/2018/03/19/state-of-clojure-2018"
      "news/2013/06/28/clojure-clore-async-channels"
      "news/2019/02/04/state-of-clojure-2019"
      "news/2012/05/15/anatomy-of-reducer"
      "news/2020/01/07/clojure-2020-survey" "news/2018/01/05/git-deps"
      "news/2019/06/06/clojure1-10-1"
      "news/2019/01/07/clojure-2019-survey"
      "news/2015/06/30/clojure-17"
      "news/2016/01/28/state-of-clojure-2015"
      "news/2016/05/23/introducing-clojure-spec"
      "news/2019/07/25/clojure-forum"
      "news/2020/07/23/cognitect-joins-nubank"
      "news/2017/12/08/clojure19" "news/2019/05/16/jira-migration"
      "news/2020/02/28/clojure-tap"
      "news/2020/02/20/state-of-clojure-2020"
      "news/2017/01/31/state-of-clojure-2016"
      "news/2018/12/17/clojure110"
      "news/2016/01/14/clojure-org-live"}},
   "https://www.archlinux.org/feeds/news/"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.archlinux.org.feeds.news."},
   "https://www.anandtech.com/rss/"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.anandtech.com.rss."},
   "https://www.kommersant.ru/RSS/section-hitech.xml"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-hitech.xml"},
   "http://blog.cleancoder.com/atom.xml"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/blog.cleancoder.com.atom.xml"},
   "https://www.kommersant.ru/RSS/Autopilot_on.xml"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.Autopilot_on.xml"},
   "https://bikepost.ru/rss/index/"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/bikepost.ru.rss.index."},
   "http://rss.slashdot.org/Slashdot/slashdotMain"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/rss.slashdot.org.Slashdot.slashdotMain"},
   "http://feeds.arstechnica.com/arstechnica/index/"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/feeds.arstechnica.com.arstechnica.index."},
   "https://www.computerra.ru/feed/"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.computerra.ru.feed."},
   "https://exler.ru/films/rss.xml"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/exler.ru.films.rss.xml"},
   "https://xkcd.com/atom.xml"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/xkcd.com.atom.xml"},
   "https://content.novayagazeta.ru/rss/all.xml"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/content.novayagazeta.ru.rss.all.xml"},
   "https://www.kommersant.ru/RSS/section-world.xml"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-world.xml"},
   "https://www.archlinux.org/feeds/packages/"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.archlinux.org.feeds.packages."},
   "https://habr.com/ru/rss/best/daily/"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/habr.com.ru.rss.best.daily."},
   "http://comicfeeds.chrisbenard.net/view/dilbert/default"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/comicfeeds.chrisbenard.net.view.dilbert.default"},
   "https://www.zerohedge.com/fullrss2.xml"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.zerohedge.com.fullrss2.xml"},
   "https://lenta.ru/rss"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/lenta.ru.rss"},
   "https://kiwibyrd.org/feed/"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/kiwibyrd.org.feed.",
    :item-count 27,
    :known-ids
    #{"http://kiwibyrd.org/?p=3987" "http://kiwibyrd.org/?p=4020"
      "http://kiwibyrd.org/?p=4075" "http://kiwibyrd.org/?p=4102"
      "http://kiwibyrd.org/?p=4081" "http://kiwibyrd.org/?p=4093"
      "http://kiwibyrd.org/?p=4068" "http://kiwibyrd.org/?p=3994"
      "http://kiwibyrd.org/?p=4175" "http://kiwibyrd.org/?p=4041"
      "http://kiwibyrd.org/?p=4152" "http://kiwibyrd.org/?p=4165"
      "http://kiwibyrd.org/?p=3989" "http://kiwibyrd.org/?p=4181"
      "http://kiwibyrd.org/?p=3964" "http://kiwibyrd.org/?p=3977"
      "http://kiwibyrd.org/?p=4003" "http://kiwibyrd.org/?p=4233"
      "http://kiwibyrd.org/?p=4144" "http://kiwibyrd.org/?p=4210"
      "http://kiwibyrd.org/?p=4028" "http://kiwibyrd.org/?p=4136"
      "http://kiwibyrd.org/?p=4113" "http://kiwibyrd.org/?p=4222"
      "http://kiwibyrd.org/?p=4050" "http://kiwibyrd.org/?p=4056"
      "http://kiwibyrd.org/?p=3970"}},
   "http://static.feed.rbc.ru/rbc/logical/footer/news.rss"
   {:dir
    "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/static.feed.rbc.ru.rbc.logical.footer.news.rss"}}>
#+end_src

#+begin_src clojure :results pp :wrap src clojure
@f/feed-index
#+end_src

#+RESULTS:
#+begin_src clojure
{"http://sgolub.ru/feed/"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/sgolub.ru.feed.",
  :item-count 26,
  :known-ids
  #{"http://sgolub.ru/?p=13463" "http://sgolub.ru/?p=13611"
    "http://sgolub.ru/?p=13654" "http://sgolub.ru/?p=13520"
    "http://sgolub.ru/?p=13558" "http://sgolub.ru/?p=13684"
    "http://sgolub.ru/?p=13551" "http://sgolub.ru/?p=13458"
    "http://sgolub.ru/?p=13505" "http://sgolub.ru/?p=13511"
    "http://sgolub.ru/?p=13564" "http://sgolub.ru/?p=13584"
    "http://sgolub.ru/?p=13546" "http://sgolub.ru/?p=13580"
    "http://sgolub.ru/?p=13515" "http://sgolub.ru/?p=13473"
    "http://sgolub.ru/?p=13526" "http://sgolub.ru/?p=13538"
    "http://sgolub.ru/?p=13477" "http://sgolub.ru/?p=13643"
    "http://sgolub.ru/?p=13530" "http://sgolub.ru/?p=13571"
    "http://sgolub.ru/?p=13576" "http://sgolub.ru/?p=13595"
    "http://sgolub.ru/?p=13602" "http://sgolub.ru/?p=13534"}},
 "https://news.ycombinator.com/rss"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/news.ycombinator.com.rss"},
 "http://www.opennet.ru/opennews/opennews_all.rss"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.opennet.ru.opennews.opennews_all.rss"},
 "https://www.kommersant.ru/RSS/section-politics.xml"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-politics.xml"},
 "http://4pda.ru/feed/"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/4pda.ru.feed."},
 "https://clojure.org/feed.xml"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/clojure.org.feed.xml",
  :item-count 25,
  :known-ids
  #{"news/2011/07/22/introducing-clojurescript"
    "news/2014/08/06/transducers-are-coming" "news/2012/05/08/reducers"
    "news/2012/02/17/clojure-governance" "news/2016/01/19/clojure18"
    "news/2018/03/19/state-of-clojure-2018"
    "news/2013/06/28/clojure-clore-async-channels"
    "news/2019/02/04/state-of-clojure-2019"
    "news/2012/05/15/anatomy-of-reducer"
    "news/2020/01/07/clojure-2020-survey" "news/2018/01/05/git-deps"
    "news/2019/06/06/clojure1-10-1"
    "news/2019/01/07/clojure-2019-survey" "news/2015/06/30/clojure-17"
    "news/2016/01/28/state-of-clojure-2015"
    "news/2016/05/23/introducing-clojure-spec"
    "news/2019/07/25/clojure-forum"
    "news/2020/07/23/cognitect-joins-nubank"
    "news/2017/12/08/clojure19" "news/2019/05/16/jira-migration"
    "news/2020/02/28/clojure-tap"
    "news/2020/02/20/state-of-clojure-2020"
    "news/2017/01/31/state-of-clojure-2016"
    "news/2018/12/17/clojure110" "news/2016/01/14/clojure-org-live"}},
 "https://www.archlinux.org/feeds/news/"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.archlinux.org.feeds.news."},
 "https://www.anandtech.com/rss/"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.anandtech.com.rss."},
 "https://www.kommersant.ru/RSS/section-hitech.xml"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-hitech.xml"},
 "http://blog.cleancoder.com/atom.xml"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/blog.cleancoder.com.atom.xml"},
 "https://www.kommersant.ru/RSS/Autopilot_on.xml"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.Autopilot_on.xml"},
 "https://bikepost.ru/rss/index/"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/bikepost.ru.rss.index."},
 "http://rss.slashdot.org/Slashdot/slashdotMain"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/rss.slashdot.org.Slashdot.slashdotMain"},
 "http://feeds.arstechnica.com/arstechnica/index/"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/feeds.arstechnica.com.arstechnica.index."},
 "https://www.computerra.ru/feed/"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.computerra.ru.feed."},
 "https://exler.ru/films/rss.xml"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/exler.ru.films.rss.xml"},
 "https://xkcd.com/atom.xml"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/xkcd.com.atom.xml"},
 "https://content.novayagazeta.ru/rss/all.xml"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/content.novayagazeta.ru.rss.all.xml"},
 "https://www.kommersant.ru/RSS/section-world.xml"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-world.xml"},
 "https://www.archlinux.org/feeds/packages/"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.archlinux.org.feeds.packages."},
 "https://habr.com/ru/rss/best/daily/"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/habr.com.ru.rss.best.daily."},
 "http://comicfeeds.chrisbenard.net/view/dilbert/default"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/comicfeeds.chrisbenard.net.view.dilbert.default"},
 "https://www.zerohedge.com/fullrss2.xml"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.zerohedge.com.fullrss2.xml"},
 "https://lenta.ru/rss"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/lenta.ru.rss"},
 "https://kiwibyrd.org/feed/"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/kiwibyrd.org.feed.",
  :item-count 27,
  :known-ids
  #{"http://kiwibyrd.org/?p=3987" "http://kiwibyrd.org/?p=4020"
    "http://kiwibyrd.org/?p=4075" "http://kiwibyrd.org/?p=4102"
    "http://kiwibyrd.org/?p=4081" "http://kiwibyrd.org/?p=4093"
    "http://kiwibyrd.org/?p=4068" "http://kiwibyrd.org/?p=3994"
    "http://kiwibyrd.org/?p=4175" "http://kiwibyrd.org/?p=4041"
    "http://kiwibyrd.org/?p=4152" "http://kiwibyrd.org/?p=4165"
    "http://kiwibyrd.org/?p=3989" "http://kiwibyrd.org/?p=4181"
    "http://kiwibyrd.org/?p=3964" "http://kiwibyrd.org/?p=3977"
    "http://kiwibyrd.org/?p=4003" "http://kiwibyrd.org/?p=4233"
    "http://kiwibyrd.org/?p=4144" "http://kiwibyrd.org/?p=4210"
    "http://kiwibyrd.org/?p=4028" "http://kiwibyrd.org/?p=4136"
    "http://kiwibyrd.org/?p=4113" "http://kiwibyrd.org/?p=4222"
    "http://kiwibyrd.org/?p=4050" "http://kiwibyrd.org/?p=4056"
    "http://kiwibyrd.org/?p=3970"}},
 "http://static.feed.rbc.ru/rbc/logical/footer/news.rss"
 {:dir
  "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/static.feed.rbc.ru.rbc.logical.footer.news.rss"}}
#+end_src


#+begin_src clojure :results output
(m/_run-srv)
#+end_src

#+RESULTS:
#+begin_example
нояб. 24, 2020 6:46:22 PM feedcircuit-revisited.stat invoke
INFO: Starting statistics collection
нояб. 24, 2020 6:46:22 PM feedcircuit-revisited.feed invoke
INFO: Starting sync by the timer
нояб. 24, 2020 6:46:22 PM feedcircuit-revisited.stat invoke
INFO: Collecting statistics for  http://sgolub.ru/feed/
2020-11-24 18:46:22.990:INFO:oejs.Server:nREPL-session-9db53d66-b7e8-484c-bcf6-7b4aa9030059: jetty-9.4.22.v20191022; built: 2019-10-22T13:37:13.455Z; git: b1e6b55512e008f7fbdf1cbea4ff8a6446d1073b; jvm 11.0.8+10
нояб. 24, 2020 6:46:22 PM feedcircuit-revisited.feed invoke
INFO: Getting news from http://sgolub.ru/feed/
2020-11-24 18:46:23.020:INFO:oejs.AbstractConnector:nREPL-session-9db53d66-b7e8-484c-bcf6-7b4aa9030059: Started ServerConnector@52bb0385{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
2020-11-24 18:46:23.020:INFO:oejs.Server:nREPL-session-9db53d66-b7e8-484c-bcf6-7b4aa9030059: Started @15808ms
#+end_example

#+begin_src clojure :results pp
(m/_restart-srv)
#+end_src

#+RESULTS:
: #'feedcircuit-revisited.main/_srv
: 2020-10-10 15:54:02.952:INFO:oejs.AbstractConnector:nREPL-session-88bac6bb-a57c-4f63-a4d4-aa7c092e07f1: Stopped ServerConnector@43a4a014{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
: 2020-10-10 15:54:02.954:INFO:oejs.Server:nREPL-session-88bac6bb-a57c-4f63-a4d4-aa7c092e07f1: jetty-9.4.22.v20191022; built: 2019-10-22T13:37:13.455Z; git: b1e6b55512e008f7fbdf1cbea4ff8a6446d1073b; jvm 11.0.8+10
: 2020-10-10 15:54:02.956:INFO:oejs.AbstractConnector:nREPL-session-88bac6bb-a57c-4f63-a4d4-aa7c092e07f1: Started ServerConnector@da12376{HTTP/1.1,[http/1.1]}{0.0.0.0:8080}
: 2020-10-10 15:54:02.956:INFO:oejs.Server:nREPL-session-88bac6bb-a57c-4f63-a4d4-aa7c092e07f1: Started @13293357ms

#+begin_src clojure :results pp :wrap src clojure
(f/sync!)
#+end_src

#+RESULTS:
#+BEGIN_src clojure
(["https://news.ycombinator.com/rss" 30]
 ["https://clojure.org/feed.xml" 0]
 ["https://www.archlinux.org/feeds/news/" 0]
 ["https://www.anandtech.com/rss/" 0]
 ["http://blog.cleancoder.com/atom.xml" 0]
 ["http://rss.slashdot.org/Slashdot/slashdotMain" 15]
 ["http://feeds.arstechnica.com/arstechnica/index/" 0]
 ["https://www.computerra.ru/feed/" 1]
 ["https://xkcd.com/atom.xml" 0]
 ["https://www.kommersant.ru/RSS/section-world.xml" 3]
 ["https://www.zerohedge.com/fullrss2.xml" 1]
 ["http://static.feed.rbc.ru/rbc/logical/footer/news.rss" 1])
июн. 08, 2020 9:56:03 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://news.ycombinator.com/rss
июн. 08, 2020 9:56:04 AM feedcircuit-revisited.feed invoke
INFO: Got 30 item from https://news.ycombinator.com/rss
июн. 08, 2020 9:56:04 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://clojure.org/feed.xml
июн. 08, 2020 9:56:05 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from https://clojure.org/feed.xml
июн. 08, 2020 9:56:05 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://www.archlinux.org/feeds/news/
июн. 08, 2020 9:56:05 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from https://www.archlinux.org/feeds/news/
июн. 08, 2020 9:56:05 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://www.anandtech.com/rss/
июн. 08, 2020 9:56:07 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from https://www.anandtech.com/rss/
июн. 08, 2020 9:56:07 AM feedcircuit-revisited.feed invoke
INFO: Getting news from http://blog.cleancoder.com/atom.xml
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from http://blog.cleancoder.com/atom.xml
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Getting news from http://rss.slashdot.org/Slashdot/slashdotMain
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Got 15 item from http://rss.slashdot.org/Slashdot/slashdotMain
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Getting news from http://feeds.arstechnica.com/arstechnica/index/
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from http://feeds.arstechnica.com/arstechnica/index/
июн. 08, 2020 9:56:08 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://www.computerra.ru/feed/
июн. 08, 2020 9:56:09 AM feedcircuit-revisited.feed invoke
INFO: Got 1 item from https://www.computerra.ru/feed/
июн. 08, 2020 9:56:09 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://xkcd.com/atom.xml
июн. 08, 2020 9:56:09 AM feedcircuit-revisited.feed invoke
INFO: Got 0 item from https://xkcd.com/atom.xml
июн. 08, 2020 9:56:09 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://www.kommersant.ru/RSS/section-world.xml
июн. 08, 2020 9:56:10 AM feedcircuit-revisited.feed invoke
INFO: Got 3 item from https://www.kommersant.ru/RSS/section-world.xml
июн. 08, 2020 9:56:10 AM feedcircuit-revisited.feed invoke
INFO: Getting news from https://www.zerohedge.com/fullrss2.xml
июн. 08, 2020 9:56:13 AM feedcircuit-revisited.feed invoke
INFO: Got 1 item from https://www.zerohedge.com/fullrss2.xml
июн. 08, 2020 9:56:13 AM feedcircuit-revisited.feed invoke
INFO: Getting news from http://static.feed.rbc.ru/rbc/logical/footer/news.rss
июн. 08, 2020 9:56:13 AM feedcircuit-revisited.feed invoke
INFO: Got 1 item from http://static.feed.rbc.ru/rbc/logical/footer/news.rss
#+END_src

#+begin_src clojure :results pp :wrap src clojure
@f/feed-dir
#+end_src

#+RESULTS:
#+BEGIN_src clojure
{"http://sgolub.ru/feed/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/sgolub.ru.feed.",
 "https://news.ycombinator.com/rss"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/news.ycombinator.com.rss",
 "http://www.opennet.ru/opennews/opennews_all.rss"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.opennet.ru.opennews.opennews_all.rss",
 "https://www.kommersant.ru/RSS/section-politics.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-politics.xml",
 "http://4pda.ru/feed/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/4pda.ru.feed.",
 "https://clojure.org/feed.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/clojure.org.feed.xml",
 "https://www.archlinux.org/feeds/news/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.archlinux.org.feeds.news.",
 "https://www.anandtech.com/rss/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.anandtech.com.rss.",
 "https://www.kommersant.ru/RSS/section-hitech.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-hitech.xml",
 "http://blog.cleancoder.com/atom.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/blog.cleancoder.com.atom.xml",
 "https://www.kommersant.ru/RSS/Autopilot_on.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.Autopilot_on.xml",
 "https://bikepost.ru/rss/index/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/bikepost.ru.rss.index.",
 "http://rss.slashdot.org/Slashdot/slashdotMain"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/rss.slashdot.org.Slashdot.slashdotMain",
 "http://feeds.arstechnica.com/arstechnica/index/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/feeds.arstechnica.com.arstechnica.index.",
 "https://www.computerra.ru/feed/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.computerra.ru.feed.",
 "https://exler.ru/films/rss.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/exler.ru.films.rss.xml",
 "https://xkcd.com/atom.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/xkcd.com.atom.xml",
 "https://content.novayagazeta.ru/rss/all.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/content.novayagazeta.ru.rss.all.xml",
 "https://www.kommersant.ru/RSS/section-world.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.kommersant.ru.RSS.section-world.xml",
 "https://www.archlinux.org/feeds/packages/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.archlinux.org.feeds.packages.",
 "http://comicfeeds.chrisbenard.net/view/dilbert/default"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/comicfeeds.chrisbenard.net.view.dilbert.default",
 "https://www.zerohedge.com/fullrss2.xml"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/www.zerohedge.com.fullrss2.xml",
 "https://lenta.ru/rss"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/lenta.ru.rss",
 "https://kiwibyrd.org/feed/"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/kiwibyrd.org.feed.",
 "http://static.feed.rbc.ru/rbc/logical/footer/news.rss"
 "/home/georgy/devel/feedcircuit-revisited/fc-data/feeds/static.feed.rbc.ru.rbc.logical.footer.news.rss"}
#+END_src

#+begin_src clojure :results pp :wrap src clojure
(c/detect (c/retrieve-and-parse "https://bikepost.ru/blog/91216/Ocherednoj-raz-vokrug-Ladogi.html") "https://bikepost.ru" nil)
#+end_src

#+RESULTS:
#+BEGIN_src clojure
class java.net.MalformedURLExceptionclass java.lang.NullPointerExceptionExecution error (NullPointerException) at java.net.URL/<init> (URL.java:585).
null
#+END_src

#+begin_src restclient
POST http://localhost:8080/selected
Cookie: sessionid=bqn1psy1rdw0lt2ky1gj25b246j4pmaf; ring-session=6nzW7ugyC7mtjrvf0cEPl8p0YuPdp2v5TrpOkGH0ktuoLFZ5vLYjE3OPKBlUthOcpE9qs%2B8IrAhrwI5rCVH7RoGnj3WCKvbSr81U0jtQvw5TD8XAXXVvw2tPdxzIN79D--UbgPoufD0NaRHjlahfABuco0LfEV31LEkJWGLjOyCl8%3D
Content-Type: application/x-www-form-urlencoded

id=https://www.exler.ru/films/vampiry-srednej-polosy.htm
#+end_src

#+RESULTS:
#+BEGIN_SRC js
// POST http://localhost:8080/selected
// HTTP/1.1 200 OK
// Date: Sat, 29 May 2021 17:18:47 GMT
// Content-Type: application/octet-stream
// X-XSS-Protection: 1; mode=block
// X-Frame-Options: SAMEORIGIN
// X-Content-Type-Options: nosniff
// Content-Length: 0
// Server: Jetty(9.4.22.v20191022)
// Request duration: 1.246895s
#+END_SRC
